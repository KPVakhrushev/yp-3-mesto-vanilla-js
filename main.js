(()=>{"use strict";var t={Card:{selector:".element",template:"#templates",image:".element__image",buttonLike:".element__like",buttonDelete:".element__delete",title:".element__title",likeActive:"element__like_active",noImageSrc:"https://upload.wikimedia.org/wikipedia/commons/1/14/No_Image_Available.jpg"},Popup:{opened:"popup_opened",buttonClose:".popup__close-button"},PopupForm:{buttonSave:".popup__save-button",awaitTitle:"Сохранение..."},PopupFormEdit:{selector:".popup_content_edit-profile"},PopupFormAdd:{selector:".popup_content_add-card"},PopupFormAvatar:{selector:".popup_content_avatar"},PopupImage:{selector:".popup_content_image",image:".popup__image",imageTitle:".popup__image-title"},UserInfo:{selector:".profile",title:".profile__title",subtitle:".profile__subtitle",buttonEdit:".profile__edit-button",avatar:".profile__avatar",buttonEditAvatar:".profile__avatar-edit"},FormValidator:{formSelector:".popup__form",inputSelector:".popup__text-input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__text-input_type_error",errorClass:"popup__error_active"},PopupDialog:{selector:".popup_content_confirm"},Api:{baseUrl:"https://mesto.nomoreparties.co/v1/cohort-66",authorization:"aaeb6289-65cb-4609-9c4e-f2ae0dcd32fb"}};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}var r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._config=n,this._form=e,this._submitButton=e.querySelector(n.submitButtonSelector),this._inputs=Array.from(this._form.querySelectorAll(n.inputSelector)),this._errorElements={}}var e,r;return e=t,(r=[{key:"_addEventListeners",value:function(){var t=this;this._form.addEventListener("input",(function(){t._form.checkValidity()?t._enableSubmitButton():t._disableSubmitButton()})),this._form.addEventListener("reset",(function(){t._disableSubmitButton(),t._inputs.forEach((function(e){return t._hideError(e)}))})),this._inputs.forEach((function(e){e.addEventListener("input",(function(){e.validity.valid?t._hideError(e):t._displayError(e,e.validationMessage)}))}))}},{key:"_getErrorElement",value:function(t){return this._errorElements[t.name]||(this._errorElements[t.name]=this._form.querySelector(".".concat(t.id,"-error"))),this._errorElements[t.name]}},{key:"_displayError",value:function(t,e){t.classList.add(this._config.inputErrorClass);var n=this._getErrorElement(t);n.textContent=e,n.classList.add(this._config.errorClass)}},{key:"_hideError",value:function(t){t.classList.remove(this._config.inputErrorClass);var e=this._getErrorElement(t);e.classList.remove(this._config.errorClass),e.textContent=""}},{key:"_disableSubmitButton",value:function(){this._submitButton.classList.add(this._config.inactiveButtonClass),this._submitButton.disabled=!0}},{key:"_enableSubmitButton",value:function(){this._submitButton.classList.remove(this._config.inactiveButtonClass),this._submitButton.disabled=!1}},{key:"enableValidation",value:function(){this._addEventListeners()}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===o(e)?e:String(e)}var a=function(){function t(e,n){var r,o,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,i=function(t){this._cardData.link=t.target.src=this._config.noImageSrc},(o=u(o="_handleImageError"))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i,this._config=n,this._element=document.querySelector(n.template).content.querySelector(n.selector).cloneNode("true"),this._title=this._selectElement("title"),this._image=this._selectElement("image"),this._likeButton=this._selectElement("buttonLike"),this._deleteButton=this._selectElement("buttonDelete"),this._handlers=a,this.setData(e),this._addListeners()}var e,n;return e=t,(n=[{key:"_selectElement",value:function(t){return this._element.querySelector(this._config[t])}},{key:"_addListeners",value:function(){var t=this;this._likeButton.addEventListener("click",(function(){return t._handlers.clickLike(t)})),this._deleteButton&&this._deleteButton.addEventListener("click",(function(){return t._handlers.clickDelete(t)})),this._image.addEventListener("error",(function(e){return t._handleImageError(e)})),this._image.addEventListener("click",(function(e){return t._handlers.click(t._cardData)}))}},{key:"setData",value:function(t){this._cardData=t,this._image.src=t.link,this._image.alt=t.name,this._title.textContent=t.name,this._likeButton.textContent=t.likes.length,this._config.userId!==this._cardData.owner._id&&this._deleteButton&&this._deleteButton.remove(),this.isLiked()?this._likeButton.classList.add(this._config.likeActive):this._likeButton.classList.remove(this._config.likeActive)}},{key:"isLiked",value:function(){var t=this;return this._cardData.likes.some((function(e){return e._id===t._config.userId}))}},{key:"getData",value:function(){return this._cardData}},{key:"getElement",value:function(){return this._element}},{key:"delete",value:function(){this._element.remove()}},{key:"getId",value:function(){return this._cardData._id}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}var s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._config=e,this._handlers=n,this._setElements(),this._setEventListeners()}var e,n;return e=t,(n=[{key:"_setElements",value:function(){this._element=document.querySelector(this._config.selector),this._buttonClose=this._selectElement("buttonClose"),this._handleEscape=this._handleEscape.bind(this)}},{key:"_selectElement",value:function(t){return this._element.querySelector(this._config[t])}},{key:"open",value:function(){this._element.classList.add(this._config.opened),this._handlers.open&&this._handlers.open(),document.addEventListener("keydown",this._handleEscape)}},{key:"close",value:function(){this._element.classList.remove(this._config.opened),document.removeEventListener("keydown",this._handleEscape)}},{key:"_handleEscape",value:function(t){"Escape"===t.key&&this.close()}},{key:"_setEventListeners",value:function(){var t=this;this._element.addEventListener("mousedown",(function(e){e.target===t._element&&t.close()})),this._buttonClose.addEventListener("click",this.close.bind(this))}},{key:"setHandler",value:function(t,e){this._handlers[t]=e}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==f(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===f(o)?o:String(o)),r)}var o}function y(){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},y.apply(this,arguments)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(r);if(o){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,(n=[{key:"_setElements",value:function(){y(d(u.prototype),"_setElements",this).call(this),this._form=this._element.querySelector("form"),this._inputList=this._form.querySelectorAll("input"),this._buttonSave=this._selectElement("buttonSave"),this._buttonSaveTitle=this._buttonSave.textContent}},{key:"_getInputValues",value:function(){var t={};return this._inputList.forEach((function(e){t[e.name]=e.value})),t}},{key:"_setEventListeners",value:function(){var t=this;this._form.addEventListener("submit",(function(e){e.preventDefault(),t._handlers.submit(t._getInputValues())})),y(d(u.prototype),"_setEventListeners",this).call(this)}},{key:"close",value:function(){this._form.reset(),y(d(u.prototype),"close",this).call(this)}},{key:"setData",value:function(t){this._inputList.forEach((function(e){t[e.name]&&(e.value=t[e.name])}))}},{key:"getForm",value:function(){return this._form}},{key:"await",value:function(t){var e=this;this._buttonSave.textContent=this._config.awaitTitle,this._buttonSave.disabled=!0,this._inputList.forEach((function(t){return t.disabled=!0})),t.finally((function(){e._buttonSave.textContent=e._buttonSaveTitle,e._buttonSave.disabled=!1,e._inputList.forEach((function(t){return t.disabled=!1}))}))}}])&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(s);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==v(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===v(o)?o:String(o)),r)}var o}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_.apply(this,arguments)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=E(r);if(o){var n=E(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t,e))._image=n._selectElement("image"),n._title=n._selectElement("imageTitle"),n}return e=u,(n=[{key:"open",value:function(t){var e=t.link,n=t.name;this._image.src=e,this._image.alt=n,this._title.textContent=n,_(E(u.prototype),"open",this).call(this)}}])&&b(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(s);function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==S(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===S(o)?o:String(o)),r)}var o}var j=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=[],this._renderer=n,this._selector=e,this._container=document.querySelector(e)}var e,n;return e=t,(n=[{key:"setItems",value:function(t){return this._items=t,this}},{key:"render",value:function(){var t=this;this._container.innerHTML="",this._items.forEach((function(e){return t._container.append(t._renderer(e))}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&w(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==P(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===P(o)?o:String(o)),r)}var o}var L=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._element=document.querySelector(e.selector),this._config=e,this._handlers=n,this._title=this._selectElement("title"),this._subtitle=this._selectElement("subtitle"),this._buttonEdit=this._selectElement("buttonEdit"),this._avatar=this._selectElement("avatar"),this._buttonEditAvatar=this._selectElement("buttonEditAvatar"),this._setEventListeners()}var e,n;return e=t,(n=[{key:"_selectElement",value:function(t){return this._element.querySelector(this._config[t])}},{key:"_setEventListeners",value:function(){this._handlers.clickEdit&&this._buttonEdit.addEventListener("click",this._handlers.clickEdit),this._handlers.clickEditAvatar&&this._buttonEditAvatar.addEventListener("click",this._handlers.clickEditAvatar)}},{key:"setUserInfo",value:function(t){return this._user=t,this._title.textContent=t.name,this._subtitle.textContent=t.about,this._avatar.src=t.avatar,t}},{key:"getUserInfo",value:function(){return this._user}},{key:"getUserId",value:function(){return this._user._id}}])&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==C(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===C(o)?o:String(o)),r)}var o}var B=function(){function t(e){var n=e.baseUrl,r=e.authorization;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=n,this._headers={authorization:r}}var e,n;return e=t,n=[{key:"_get",value:function(t){return this._fetch("GET",t)}},{key:"_patchJson",value:function(t,e){return this._fetch("PATCH",t,{"Content-Type":"application/json"},JSON.stringify(e))}},{key:"_postJson",value:function(t,e){return this._fetch("POST",t,{"Content-Type":"application/json"},JSON.stringify(e))}},{key:"_delete",value:function(t){return this._fetch("DELETE",t)}},{key:"_put",value:function(t){return this._fetch("PUT",t)}},{key:"_fetch",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o={method:t,headers:Object.assign({},this._headers,n)};return r&&(o.body=r),fetch(this._baseUrl+e,o).then((function(t){return t.ok?t:Promise.reject(t)}))}},{key:"getCards",value:function(){return this._get("/cards").then((function(t){return t.json()}))}},{key:"getMe",value:function(){return this._get("/users/me").then((function(t){return t.json()}))}},{key:"updateMe",value:function(t){var e=t.name,n=t.about;return this._patchJson("/users/me",{name:e,about:n}).then((function(t){return t.json()}))}},{key:"addCard",value:function(t){var e=t.name,n=t.link;return this._postJson("/cards",{name:e,link:n}).then((function(t){return t.json()}))}},{key:"deleteCard",value:function(t){var e=this;return this._delete("/cards/".concat(t)).catch((function(t){return e._errorHandler(t)}))}},{key:"updateMeAvatar",value:function(t){return this._patchJson("/users/me/avatar",t).then((function(t){return t.json()}))}},{key:"likeCard",value:function(t){return this._put("/cards/".concat(t,"/likes")).then((function(t){return t.json()}))}},{key:"unlikeCard",value:function(t){return this._delete("/cards/".concat(t,"/likes")).then((function(t){return t.json()}))}}],n&&T(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==I(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===I(o)?o:String(o)),r)}var o}function R(){return R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},R.apply(this,arguments)}function A(t,e){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A(t,e)}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=x(r);if(o){var n=x(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===I(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,(n=[{key:"_setElements",value:function(){R(x(u.prototype),"_setElements",this).call(this),this._buttons=this._element.querySelectorAll("button")}},{key:"_setEventListeners",value:function(){var t=this;this._buttons.forEach((function(e){e.name&&e.addEventListener("click",(function(n){t._handlers[e.name]&&t._handlers[e.name]()}))})),R(x(u.prototype),"_setEventListeners",this).call(this)}}])&&D(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(s),U=function(t,e){return t.await(e.then((function(){return t.close()})).catch(F)),e},F=function(t){console.log(t),alert("Что-то пошло не так")},V=function(e){var n=e.match(/[A-Z][a-z]+/g),r="";return function e(){return n.length?(r+=n.shift(),Object.assign({},t[r]?t[r]:{},e())):{}}()},M=function(e){return new a(e,Object.assign({userId:z.getUserId()},t.Card),{click:function(t){return N.image.open(t)},clickDelete:function(t){N.confirm.setHandler("confirm",(function(){H.deleteCard(t.getData()._id).then((function(){t.delete(),N.confirm.close()})).catch(F)})),N.confirm.open()},clickLike:function(t){(t.isLiked()?H.unlikeCard(t.getId()):H.likeCard(t.getId())).then((function(e){return t.setData(e)})).catch(F)}}).getElement()},J=new j(".elements",M),H=new B(t.Api),z=new L(t.UserInfo,{clickEdit:function(){return N.edit.open()},clickEditAvatar:function(){return N.avatar.open()}}),N={image:new k(V("PopupImage")),add:new m(V("PopupFormAdd"),{submit:function(t){return U(N.add,H.addCard(t).then((function(t){return J.addItem(M(t))})))}}),edit:new m(V("PopupFormEdit"),{open:function(){return N.edit.setData(z.getUserInfo())},submit:function(t){return U(N.edit,H.updateMe(t).then((function(t){return z.setUserInfo(t)})))}}),confirm:new q(V("PopupDialog")),avatar:new m(V("PopupFormAvatar"),{open:function(){return N.avatar.setData(z.getUserInfo())},submit:function(t){return U(N.avatar,H.updateMeAvatar(t).then((function(t){return z.setUserInfo(t)})))}})},G=new r(N.edit.getForm(),t.FormValidator),Z=new r(N.add.getForm(),t.FormValidator),K=new r(N.avatar.getForm(),t.FormValidator);G.enableValidation(),Z.enableValidation(),K.enableValidation(),Promise.all([H.getMe(),H.getCards()]).then((function(t){z.setUserInfo(t[0]),J.setItems(t[1]).render()})).catch(F),document.querySelector(".profile__add-button").addEventListener("click",(function(){return N.add.open()})),document.querySelector(".popups").classList.remove("page__hidden")})();